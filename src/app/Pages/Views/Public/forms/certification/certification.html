<!-- Hero Section -->
<div class="relative h-[180px] sm:h-[200px] md:h-[220px] overflow-hidden">
  <div class="absolute inset-0 bg-gradient-to-r from-purple-600 via-purple-700 to-indigo-600"></div>
  <div class="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"></div>
  <div class="absolute inset-0 flex items-center">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8 w-full text-center">
      <div class="inline-block mb-2 sm:mb-2.5 px-3 sm:px-4 py-1 sm:py-1.5 bg-purple-500/20 backdrop-blur-sm rounded-full border border-purple-400/30">
        <span class="text-purple-100 text-xs sm:text-sm font-semibold">üìù Certification Form</span>
      </div>
      <h1 class="text-2xl xs:text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-extrabold mb-2 sm:mb-2.5 md:mb-3 leading-tight drop-shadow-2xl text-white px-2">
        Certification Form
      </h1>
      <p class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl text-purple-100 font-medium drop-shadow-lg leading-relaxed max-w-3xl mx-auto px-2">
        Complete your certification application step by step
      </p>
    </div>
  </div>
</div>

<div class="min-h-screen bg-gradient-to-br from-purple-50 via-white to-indigo-50 py-4 sm:py-6 md:py-8 print:py-4 print:bg-white">
  <div class="max-w-5xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 print:px-6">
    <!-- Form Container -->
    <div id="certification-form-content" class="bg-white shadow-2xl rounded-lg sm:rounded-xl lg:rounded-2xl xl:rounded-3xl border-2 border-gray-200 p-3 sm:p-4 md:p-5 print:p-8 print:bg-white print:shadow-none print:border-0 print:rounded-none relative overflow-hidden">
      <!-- Decorative Background -->
      <div class="absolute top-0 right-0 w-64 h-64 bg-purple-200/20 rounded-full blur-3xl -z-10 print:hidden"></div>
      <div class="absolute bottom-0 left-0 w-48 h-48 bg-indigo-200/20 rounded-full blur-3xl -z-10 print:hidden"></div>

      <!-- Verification Form (Show if not verified) -->
      <div *ngIf="!isVerified" class="space-y-6 animate-fadeIn">
        <div class="bg-white rounded-xl p-5 sm:p-6 md:p-8 border-2 border-gray-200 shadow-lg">
          <div class="flex items-center mb-5 sm:mb-6">
            <div class="w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl mr-3 sm:mr-4 shadow-lg">
              <i class="ri-shield-check-line text-2xl sm:text-3xl text-white"></i>
            </div>
            <h2 class="text-xl sm:text-2xl md:text-3xl font-extrabold text-gray-900">Student Verification</h2>
          </div>

          <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">
            Please enter your Enrolment Number and Date of Birth to verify your identity and auto-fill the form.
          </p>

          <!-- Test Credentials Info -->
          <div class="bg-purple-50 border-l-4 border-purple-500 text-purple-800 p-3 sm:p-4 rounded-lg mb-5 sm:mb-6">
            <div class="flex items-start gap-2">
              <i class="ri-information-line text-lg mt-0.5"></i>
              <div class="flex-1">
                <p class="font-semibold text-sm mb-2">Test Credentials (For Testing):</p>
                <div class="text-xs space-y-1">
                  <p><strong>Option 1:</strong> Enrolment: <code class="bg-purple-100 px-1.5 py-0.5 rounded">CIPC-2025-0101-12345</code> | DOB: <code class="bg-purple-100 px-1.5 py-0.5 rounded">15/01/2000</code></p>
                  <p><strong>Option 2:</strong> Enrolment: <code class="bg-purple-100 px-1.5 py-0.5 rounded">CIPC-2025-0101-54321</code> | DOB: <code class="bg-purple-100 px-1.5 py-0.5 rounded">20/05/1999</code></p>
                  <p><strong>Option 3:</strong> Enrolment: <code class="bg-purple-100 px-1.5 py-0.5 rounded">TEST123</code> | DOB: <code class="bg-purple-100 px-1.5 py-0.5 rounded">25/12/2001</code></p>
                </div>
              </div>
            </div>
          </div>

          <form [formGroup]="verificationForm" (ngSubmit)="verifyStudent()" class="space-y-5">
            <!-- Enrolment Number -->
            <div>
              <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2">
                Enrolment Number: <span class="text-red-600">*</span>
              </label>
              <input type="text" formControlName="enrolmentNumber" 
                class="w-full border-2 border-gray-300 bg-white px-3 py-2 text-sm rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all"
                [class.border-red-500]="verificationForm.get('enrolmentNumber')?.invalid && verificationForm.get('enrolmentNumber')?.touched"
                placeholder="Enter your enrolment number">
              <p *ngIf="verificationForm.get('enrolmentNumber')?.invalid && verificationForm.get('enrolmentNumber')?.touched" 
                class="text-red-600 text-xs mt-1.5 flex items-center gap-1">
                <i class="ri-error-warning-line text-sm"></i>
                Enrolment number is required (minimum 5 characters)
              </p>
            </div>

            <!-- Date of Birth -->
            <div>
              <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2">
                Date of Birth: <span class="text-red-600">*</span>
              </label>
              
              <!-- Calendar Datepicker -->
              <div class="mb-3">
                <div class="flex items-center gap-2 bg-purple-50 border-2 border-purple-200 rounded-lg px-3 py-2 hover:border-purple-400 transition-colors">
                  <i class="ri-calendar-line text-purple-600 text-lg"></i>
                  <mat-form-field appearance="fill" class="m-0 p-0 w-full">
                    <input matInput [matDatepicker]="verifyPicker" formControlName="dateOfBirthFull" 
                      (dateChange)="onVerificationDateSelected($event)"
                      [max]="maxDateDOB"
                      readonly
                      class="border-0 bg-transparent px-2 py-1 text-sm focus:outline-none w-full cursor-pointer"
                      placeholder="Select Date from Calendar">
                    <mat-datepicker-toggle matIconSuffix [for]="verifyPicker" class="text-purple-600"></mat-datepicker-toggle>
                    <mat-datepicker #verifyPicker></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>

              <!-- Manual Date Input -->
              <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                <p class="text-xs text-gray-600 mb-2 flex items-center gap-1">
                  <i class="ri-information-line"></i>
                  Or enter manually:
                </p>
                <div class="grid grid-cols-3 gap-2">
                  <div>
                    <label class="block text-xs text-gray-600 mb-1">Day</label>
                    <input type="number" formControlName="dateOfBirth" maxlength="2" min="1" max="31"
                      (input)="validateVerificationDateInput($event, 'dateOfBirth', 1, 31)"
                      (blur)="syncVerificationDateFromManualInputs()"
                      class="w-full border-2 border-gray-300 bg-white px-2 py-1 text-xs rounded-md focus:outline-none focus:border-purple-500"
                      [class.border-red-500]="verificationForm.get('dateOfBirth')?.invalid && verificationForm.get('dateOfBirth')?.touched"
                      placeholder="DD">
                  </div>
                  <div>
                    <label class="block text-xs text-gray-600 mb-1">Month</label>
                    <input type="number" formControlName="monthOfBirth" maxlength="2" min="1" max="12"
                      (input)="validateVerificationDateInput($event, 'monthOfBirth', 1, 12)"
                      (blur)="syncVerificationDateFromManualInputs()"
                      class="w-full border-2 border-gray-300 bg-white px-2 py-1 text-xs rounded-md focus:outline-none focus:border-purple-500"
                      [class.border-red-500]="verificationForm.get('monthOfBirth')?.invalid && verificationForm.get('monthOfBirth')?.touched"
                      placeholder="MM">
                  </div>
                  <div>
                    <label class="block text-xs text-gray-600 mb-1">Year</label>
                    <input type="number" formControlName="yearOfBirth" maxlength="4" min="1950" [max]="maxDateDOB.getFullYear()"
                      (input)="syncVerificationDateFromManualInputs()"
                      class="w-full border-2 border-gray-300 bg-white px-2 py-1 text-xs rounded-md focus:outline-none focus:border-purple-500"
                      [class.border-red-500]="verificationForm.get('yearOfBirth')?.invalid && verificationForm.get('yearOfBirth')?.touched"
                      placeholder="YYYY">
                  </div>
                </div>
                <p *ngIf="verificationForm.get('dateOfBirth')?.value && verificationForm.get('monthOfBirth')?.value && verificationForm.get('yearOfBirth')?.value" 
                  class="text-xs text-gray-500 mt-2 flex items-center gap-1">
                  <i class="ri-check-line text-green-600"></i>
                  Selected: {{ verificationForm.get('dateOfBirth')?.value }}/{{ verificationForm.get('monthOfBirth')?.value }}/{{ verificationForm.get('yearOfBirth')?.value }}
                </p>
                <p *ngIf="(verificationForm.get('dateOfBirth')?.invalid || verificationForm.get('monthOfBirth')?.invalid || verificationForm.get('yearOfBirth')?.invalid) && (verificationForm.get('dateOfBirth')?.touched || verificationForm.get('monthOfBirth')?.touched || verificationForm.get('yearOfBirth')?.touched)" 
                  class="text-red-600 text-[10px] mt-1 flex items-center gap-1 bg-red-50 p-1 rounded-md">
                  <i class="ri-error-warning-line"></i>
                  Please enter a valid date of birth
                </p>
              </div>
            </div>

            <!-- Error Message -->
            <div *ngIf="verificationError" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-3 rounded-lg">
              <div class="flex items-center gap-2">
                <i class="ri-error-warning-line text-lg"></i>
                <p class="text-sm font-semibold">{{ verificationError }}</p>
              </div>
            </div>

            <!-- Verify Button -->
            <button type="submit" 
              [disabled]="isVerifying || verificationForm.invalid"
              class="w-full bg-gradient-to-r from-purple-600 to-indigo-700 hover:from-purple-700 hover:to-indigo-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold text-sm transition-all shadow-md hover:shadow-lg transform hover:scale-105 disabled:transform-none flex items-center justify-center gap-2">
              <i *ngIf="!isVerifying" class="ri-shield-check-line text-base"></i>
              <i *ngIf="isVerifying" class="ri-loader-4-line text-base animate-spin"></i>
              {{ isVerifying ? 'Verifying...' : 'Verify & Continue' }}
            </button>
          </form>
        </div>
      </div>

      <!-- Certification Form (Show only if verified) -->
      <div *ngIf="isVerified" [formGroup]="certificationForm">
      <!-- College Logo and Name Header -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 mb-6 sm:mb-8 print:mb-4 pb-6 sm:pb-8 border-b-2 border-gray-300 print:border-b print:border-black">
        <div class="flex-shrink-0">
          <img src="Assets/logos/image.png" alt="CIPC Logo" 
               class="h-16 sm:h-20 md:h-24 w-auto max-w-[160px] sm:max-w-[200px] md:max-w-[240px] object-contain print:h-16 print:max-w-[140px]"
               onerror="this.onerror=null; this.src='Assets/logos/image.png';">
        </div>
        <div class="flex-1 text-center sm:text-left">
          <h1 class="text-lg sm:text-xl md:text-2xl font-bold text-gray-800 mb-1.5 print:text-lg">
            CIPC PARAMEDICAL COUNCIL
          </h1>
          <p class="text-xs sm:text-sm text-gray-600 print:text-[10px]">
            Varanasi, Uttar Pradesh, India
          </p>
          <p class="text-[10px] sm:text-xs text-gray-500 mt-1 print:text-[9px]">
            ISO Certified Institution
          </p>
        </div>
      </div>

      <!-- Form Title and Photo -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4 mb-6 print:mb-4 print:grid-cols-1">
        <!-- Form Title -->
        <div class="md:col-span-2 border-4 border-purple-600 bg-gradient-to-br from-purple-600 via-purple-700 to-indigo-600 text-white p-3 sm:p-4 text-center font-bold text-lg sm:text-xl md:text-2xl print:text-lg print:p-2 print:border-2 print:border-black print:bg-white print:text-black rounded-xl shadow-2xl print:rounded-none print:shadow-none relative overflow-hidden group">
          <div class="absolute inset-0 opacity-10">
            <div class="absolute top-0 left-0 w-24 h-24 bg-white rounded-full -translate-x-12 -translate-y-12"></div>
            <div class="absolute bottom-0 right-0 w-32 h-32 bg-white rounded-full translate-x-16 translate-y-16"></div>
          </div>
          <div class="relative z-10 flex flex-col items-center justify-center">
            <div class="flex items-center gap-1.5 mb-1">
              <i class="ri-award-line text-xl sm:text-2xl md:text-2xl print:hidden"></i>
              <h2 class="text-lg sm:text-xl md:text-2xl print:text-lg tracking-wide">CERTIFICATION FORM</h2>
            </div>
            <div class="w-20 h-0.5 bg-white/50 rounded-full mt-1.5 print:hidden"></div>
            <p class="text-xs sm:text-sm mt-1.5 opacity-90 print:hidden">Fill all the required fields carefully</p>
          </div>
        </div>

        <!-- Photo Upload Section -->
        <div class="border-2 border-gray-300 bg-gradient-to-br from-white via-gray-50 to-white p-3 sm:p-3.5 text-center w-full md:w-auto print:w-40 print:p-3 print:border-black print:bg-white rounded-xl shadow-xl print:rounded-none print:shadow-none relative hover:border-purple-500 hover:shadow-2xl transition-all duration-300 group">
          <div class="mb-2 print:mb-1">
            <div *ngIf="studentPhotoPreview" class="relative">
              <img [src]="studentPhotoPreview" alt="Student Photo" 
                   class="w-full h-auto max-h-28 sm:max-h-32 md:max-h-36 object-cover border-2 border-gray-300 rounded-lg shadow-lg print:max-h-28 print:border print:rounded-none group-hover:scale-105 transition-transform duration-300">
              <button type="button" (click)="removePhoto()" 
                      class="absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 shadow-lg hover:shadow-xl transition-all print:hidden flex items-center justify-center group/btn">
                <i class="ri-close-line text-xs group-hover/btn:rotate-90 transition-transform"></i>
              </button>
            </div>
            <div *ngIf="!studentPhotoPreview" class="relative">
              <div class="w-full h-24 sm:h-28 md:h-32 bg-gradient-to-br from-purple-50 via-gray-50 to-indigo-50 border-2 border-dashed border-purple-300 flex flex-col items-center justify-center rounded-lg print:h-20 print:border print:rounded-none hover:border-purple-500 hover:bg-purple-50 transition-all duration-300 group-hover:scale-105">
                <div class="bg-purple-100 rounded-full p-2 mb-1.5 group-hover:bg-purple-200 transition-colors print:hidden">
                  <i class="ri-camera-line text-2xl sm:text-3xl text-purple-600"></i>
                </div>
                <span class="text-xs sm:text-sm font-medium text-gray-600 print:hidden">Student Photo</span>
                <span class="text-[9px] text-gray-400 mt-1 print:hidden">Click to upload</span>
              </div>
            </div>
          </div>
          
          <input type="file" id="studentPhotoInput" 
                 accept="image/jpeg,image/jpg,image/png,image/gif"
                 (change)="onPhotoSelected($event)"
                 class="hidden print:hidden">
          
          <label for="studentPhotoInput" 
                 class="cursor-pointer text-xs sm:text-sm text-white bg-gradient-to-r from-purple-600 via-purple-700 to-indigo-600 hover:from-purple-700 hover:via-purple-800 hover:to-indigo-700 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg shadow-lg hover:shadow-xl transition-all print:hidden block font-semibold flex items-center justify-center gap-1.5 group/label transform hover:scale-105">
            <i class="ri-upload-cloud-2-line text-base group-hover/label:animate-bounce"></i>
            <span>{{ studentPhotoPreview ? 'Change Photo' : 'Upload Photo' }}</span>
          </label>
          
          <p class="text-[9px] text-gray-500 mt-1.5 print:hidden">
            <i class="ri-information-line"></i> Max 2MB, JPG/PNG
          </p>
        </div>
      </div>

      <!-- Form Fields -->
      <form class="space-y-5 print:space-y-3">
        <!-- Certificate Number -->
        <div class="bg-gradient-to-r from-gray-50 to-purple-50 p-4 rounded-lg border-2 border-gray-200 shadow-md print:bg-transparent print:border-0 print:p-0">
          <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Certificate Number (For office use only):</label>
          <input type="text" formControlName="certificateNumber" 
            class="w-full border-2 border-gray-300 bg-gray-100 px-3 py-2.5 text-sm sm:text-base rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
            readonly>
        </div>

        <!-- Row 1: Enrolment Number and Student Name - 2 Columns -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5 print:grid-cols-1 print:gap-3">
          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Enrolment Number: <span class="text-red-600">*</span></label>
            <input type="text" formControlName="enrolmentNumber" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                [class.border-red-500]="hasError('enrolmentNumber')"
                placeholder="Enter enrolment number">
            <p *ngIf="hasError('enrolmentNumber')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('enrolmentNumber') }}
            </p>
          </div>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Student Name (In Capital Letters): <span class="text-red-600">*</span></label>
            <input type="text" formControlName="studentName" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md uppercase font-semibold print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
              [class.border-red-500]="hasError('studentName')"
              placeholder="Enter your full name">
            <p *ngIf="hasError('studentName')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('studentName') }}
            </p>
          </div>
        </div>

        <!-- Row 2: Course and Completion Date - 2 Columns -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5 print:grid-cols-1 print:gap-3">
          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Course: <span class="text-red-600">*</span></label>
            <mat-form-field appearance="fill" class="m-0 p-0 w-full">
              <input type="text" matInput formControlName="course" 
                [matAutocomplete]="autoCourse"
                placeholder="Search or select course"
                class="border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md w-full print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                [class.border-red-500]="hasError('course')">
              <mat-autocomplete #autoCourse="matAutocomplete" [displayWith]="displayCourse" class="max-h-[250px]">
                <mat-option *ngFor="let course of filteredCourses | async" [value]="course" class="text-sm sm:text-base py-2.5 px-4 min-h-[40px] hover:bg-purple-50">
                  <i class="ri-book-line text-purple-600 mr-2"></i>{{ course }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <p *ngIf="hasError('course')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('course') }}
            </p>
          </div>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Completion Date: <span class="text-red-600">*</span></label>
            <div class="flex items-center gap-2 print:hidden bg-purple-50 border-2 border-purple-200 rounded-md px-3 py-2 hover:border-purple-400 transition-colors">
              <i class="ri-calendar-line text-purple-600 text-lg"></i>
              <mat-form-field appearance="fill" class="m-0 p-0 w-full">
                <input matInput [matDatepicker]="picker" formControlName="completionDateFull" 
                  (dateChange)="onDateSelected($event)"
                  readonly
                  class="border-0 bg-transparent px-2 py-1 text-sm sm:text-base focus:outline-none w-full cursor-pointer"
                  [class.text-red-500]="hasError('completionDate')">
                <mat-datepicker-toggle matIconSuffix [for]="picker" class="text-purple-600"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
            </div>
            <input type="text" formControlName="completionDate" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none print:block"
              placeholder="DD/MM/YYYY"
              [class.border-red-500]="hasError('completionDate')">
            <p *ngIf="hasError('completionDate')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('completionDate') }}
            </p>
          </div>
        </div>

        <!-- Row 3: Grade and Marks - 2 Columns -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5 print:grid-cols-1 print:gap-3">
          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Grade: <span class="text-red-600">*</span></label>
            <mat-form-field appearance="fill" class="m-0 p-0 w-full">
              <input type="text" matInput formControlName="grade" 
                [matAutocomplete]="autoGrade"
                placeholder="Search or select grade"
                class="border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md w-full print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                [class.border-red-500]="hasError('grade')">
              <mat-autocomplete #autoGrade="matAutocomplete" [displayWith]="displayGrade" class="max-h-[250px]">
                <mat-option *ngFor="let grade of filteredGrades | async" [value]="grade" class="text-sm sm:text-base py-2.5 px-4 min-h-[40px] hover:bg-purple-50">
                  <i class="ri-star-line text-purple-600 mr-2"></i>{{ grade }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <p *ngIf="hasError('grade')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('grade') }}
            </p>
          </div>

          <div class="grid grid-cols-2 gap-3">
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
              <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Marks Obtained:</label>
              <input type="text" formControlName="marksObtained" 
                class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                placeholder="Marks">
            </div>

            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
              <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Total Marks:</label>
              <input type="text" formControlName="totalMarks" 
                class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                placeholder="Total">
            </div>
          </div>
        </div>

        <!-- Row 4: Full Postal Address - Full Width -->
        <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
          <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Full Postal Address: <span class="text-red-600">*</span></label>
          <textarea formControlName="fullPostalAddress" rows="3"
            class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md resize-none print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
            [class.border-red-500]="hasError('fullPostalAddress')"
            placeholder="Enter your complete postal address"></textarea>
          <p *ngIf="hasError('fullPostalAddress')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
            <i class="ri-error-warning-line text-sm"></i>
            {{ getErrorMessage('fullPostalAddress') }}
          </p>
        </div>

        <!-- Row 5: District, State, Pin Code - 3 Columns -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-5 print:grid-cols-1 print:gap-3">
          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">State: <span class="text-red-600">*</span></label>
            <mat-form-field appearance="fill" class="m-0 p-0 w-full">
              <input type="text" matInput formControlName="state" 
                [matAutocomplete]="autoState"
                placeholder="Search or select state"
                class="border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md w-full print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                [class.border-red-500]="hasError('state')">
              <mat-autocomplete #autoState="matAutocomplete" [displayWith]="displayState" class="max-h-[250px]">
                <mat-option *ngFor="let state of filteredStates | async" [value]="state" class="text-sm sm:text-base py-2.5 px-4 min-h-[40px] hover:bg-purple-50">
                  <i class="ri-map-pin-line text-purple-600 mr-2"></i>{{ state }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <p *ngIf="hasError('state')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('state') }}
            </p>
          </div>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">District: <span class="text-red-600">*</span></label>
            <mat-form-field appearance="fill" class="m-0 p-0 w-full">
              <input type="text" matInput formControlName="district" 
                [matAutocomplete]="autoDistrict"
                [placeholder]="certificationForm.get('state')?.value ? 'Search or select district' : 'Select State First'"
                class="border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md w-full disabled:bg-gray-100 disabled:cursor-not-allowed print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
                [class.border-red-500]="hasError('district')"
                [disabled]="!certificationForm.get('state')?.value">
              <mat-autocomplete #autoDistrict="matAutocomplete" [displayWith]="displayDistrict" class="max-h-[250px]">
                <mat-option *ngFor="let district of filteredDistricts | async" [value]="district" class="text-sm sm:text-base py-2.5 px-4 min-h-[40px] hover:bg-purple-50">
                  <i class="ri-community-line text-purple-600 mr-2"></i>{{ district }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <p *ngIf="hasError('district')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('district') }}
            </p>
          </div>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Pin Code: <span class="text-red-600">*</span></label>
            <input type="text" formControlName="pinCode" maxlength="6" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
              placeholder="6 digits"
              [class.border-red-500]="hasError('pinCode')">
            <p *ngIf="hasError('pinCode')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('pinCode') }}
            </p>
          </div>
        </div>

        <!-- Row 6: Mobile Number and Email - 2 Columns -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5 print:grid-cols-1 print:gap-3">
          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Mobile No.: <span class="text-red-600">*</span></label>
            <input type="tel" formControlName="mobileNo" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
              placeholder="10 digits"
              [class.border-red-500]="hasError('mobileNo')">
            <p *ngIf="hasError('mobileNo')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('mobileNo') }}
            </p>
          </div>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow print:bg-transparent print:border-0 print:p-0 print:shadow-none">
            <label class="block font-bold text-sm sm:text-base text-gray-700 mb-2 print:text-xs">Email: <span class="text-gray-500 text-xs">(Optional)</span></label>
            <input type="email" formControlName="email" 
              class="w-full border-2 border-gray-300 bg-white px-3 py-2.5 text-sm sm:text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 rounded-md print:text-xs print:px-1 print:py-0 print:border-b-2 print:border-dotted print:border-black print:bg-transparent print:h-4 print:rounded-none"
              placeholder="example@email.com"
              [class.border-red-500]="hasError('email')">
            <p *ngIf="hasError('email')" class="text-red-600 text-xs mt-1.5 flex items-center gap-1 print:hidden">
              <i class="ri-error-warning-line text-sm"></i>
              {{ getErrorMessage('email') }}
            </p>
          </div>
        </div>
      </form>

      <!-- Success Message -->
      <div *ngIf="submitSuccess" class="mt-8 p-5 bg-gradient-to-r from-green-50 to-green-100 border-l-4 border-green-500 text-green-800 rounded-lg shadow-lg print:hidden">
        <div class="flex items-center gap-3">
          <i class="ri-checkbox-circle-fill text-3xl text-green-600"></i>
          <div>
            <p class="font-bold text-lg">Form Submitted Successfully!</p>
            <p class="text-sm mt-1">Form has been printed, downloaded, and email opened.</p>
          </div>
        </div>
      </div>

      <!-- Processing Message -->
      <div *ngIf="isProcessing" class="mt-8 p-5 bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-500 text-blue-800 rounded-lg shadow-lg print:hidden">
        <div class="flex items-center gap-3">
          <i class="ri-loader-4-line text-3xl text-blue-600 animate-spin"></i>
          <div>
            <p class="font-bold text-lg">Processing...</p>
            <p class="text-sm mt-1">Please wait while we process your form.</p>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="mt-10 flex flex-wrap gap-4 justify-center print:hidden">
        <button type="button" (click)="onSubmit()" [disabled]="isProcessing"
          class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed text-white px-10 py-4 rounded-lg font-bold text-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none flex items-center gap-2">
          <i class="ri-check-line text-xl"></i>
          {{ isProcessing ? 'Processing...' : 'Submit Form' }}
        </button>
        <button type="button" (click)="resetForm()" [disabled]="isProcessing"
          class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed text-white px-10 py-4 rounded-lg font-bold text-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none flex items-center gap-2">
          <i class="ri-refresh-line text-xl"></i>
          Reset Form
        </button>
      </div>
      </div>
      <!-- End of Certification Form (verified section) -->
    </div>
  </div>
</div>

